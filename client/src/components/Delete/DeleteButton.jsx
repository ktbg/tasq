
import { useHistory } from 'react-router';
import { Fragment } from 'react';
import Media from 'react-media';
import { deleteList, deleteItem } from '../../services';
import TrashCan from './TrashCan';

export default function DeleteButton(props) {
  const {items, id, type, className} = props;
  const history = useHistory();

  const handleDelete = async () => {
    const urlEncode = items.map((item) => {
      return item.id;
    })
    urlEncode.forEach(async(id) => {
      await deleteItem(id);
    });
    await deleteList(id);
    history.push('/');
  }

  return (
    <button className={className} onClick={handleDelete}>
      {type==="detail" ? (
      // code reference from react-media docs: https://github.com/ReactTraining/react-media
        <Media queries={{ 
          iPad:"(min-width: 1024px)",
          mobile:"(max-width: 1023px)",
          }}>
              {matches =>(
                <Fragment>
                  {matches.iPad && 
                    <svg width="90" height="34" viewBox="0 0 90 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect y="0.5" width="90" height="33" rx="8" fill="#E0635E"/>
                      <path d="M16.83 11.7H12.98V21.5H16.83C19.532 21.5 21.52 19.33 21.52 16.6C21.52 13.856 19.532 11.7 16.83 11.7ZM16.83 19.96H14.59V13.24H16.83C18.692 13.24 19.966 14.654 19.966 16.6C19.966 18.532 18.692 19.96 16.83 19.96ZM23.9148 18.644H29.4868C29.5148 18.448 29.5428 18.224 29.5428 18.014C29.5428 15.998 28.1148 14.318 26.0288 14.318C23.8308 14.318 22.3328 15.928 22.3328 18C22.3328 20.1 23.8308 21.682 26.1408 21.682C27.5128 21.682 28.5628 21.108 29.2068 20.156L27.9608 19.428C27.6248 19.918 26.9948 20.296 26.1548 20.296C25.0348 20.296 24.1528 19.736 23.9148 18.644ZM23.9008 17.412C24.1108 16.362 24.8808 15.69 26.0148 15.69C26.9248 15.69 27.8068 16.208 28.0168 17.412H23.9008ZM30.7083 21.5H32.2203V11.28H30.7083V21.5ZM35.0008 18.644H40.5728C40.6008 18.448 40.6288 18.224 40.6288 18.014C40.6288 15.998 39.2008 14.318 37.1148 14.318C34.9168 14.318 33.4188 15.928 33.4188 18C33.4188 20.1 34.9168 21.682 37.2268 21.682C38.5988 21.682 39.6488 21.108 40.2928 20.156L39.0468 19.428C38.7108 19.918 38.0808 20.296 37.2408 20.296C36.1208 20.296 35.2388 19.736 35.0008 18.644ZM34.9868 17.412C35.1968 16.362 35.9668 15.69 37.1008 15.69C38.0108 15.69 38.8928 16.208 39.1028 17.412H34.9868ZM45.4815 15.956V14.5H43.7455V12.54L42.2335 12.988V14.5H40.9455V15.956H42.2335V19.316C42.2335 21.136 43.1575 21.78 45.4815 21.5V20.142C44.3335 20.198 43.7455 20.212 43.7455 19.316V15.956H45.4815ZM47.5907 18.644H53.1627C53.1907 18.448 53.2187 18.224 53.2187 18.014C53.2187 15.998 51.7907 14.318 49.7047 14.318C47.5067 14.318 46.0087 15.928 46.0087 18C46.0087 20.1 47.5067 21.682 49.8167 21.682C51.1887 21.682 52.2387 21.108 52.8827 20.156L51.6367 19.428C51.3007 19.918 50.6707 20.296 49.8307 20.296C48.7107 20.296 47.8287 19.736 47.5907 18.644ZM47.5767 17.412C47.7867 16.362 48.5567 15.69 49.6907 15.69C50.6007 15.69 51.4827 16.208 51.6927 17.412H47.5767ZM59.4272 19.96V11.7H57.8172V21.5H63.4172V19.96H59.4272ZM65.1051 13.45C65.6371 13.45 66.0711 13.002 66.0711 12.484C66.0711 11.952 65.6371 11.518 65.1051 11.518C64.5731 11.518 64.1391 11.952 64.1391 12.484C64.1391 13.002 64.5731 13.45 65.1051 13.45ZM64.3491 21.5H65.8611V14.5H64.3491V21.5ZM68.7687 16.432C68.7687 15.928 69.2447 15.69 69.7907 15.69C70.3647 15.69 70.8547 15.942 71.1067 16.488L72.3807 15.774C71.8907 14.85 70.9387 14.318 69.7907 14.318C68.3627 14.318 67.2287 15.144 67.2287 16.46C67.2287 18.966 70.9947 18.266 70.9947 19.512C70.9947 20.072 70.4767 20.296 69.8047 20.296C69.0347 20.296 68.4747 19.918 68.2507 19.288L66.9487 20.044C67.3967 21.052 68.4047 21.682 69.8047 21.682C71.3167 21.682 72.5347 20.926 72.5347 19.526C72.5347 16.936 68.7687 17.706 68.7687 16.432ZM77.3314 15.956V14.5H75.5954V12.54L74.0834 12.988V14.5H72.7954V15.956H74.0834V19.316C74.0834 21.136 75.0074 21.78 77.3314 21.5V20.142C76.1834 20.198 75.5954 20.212 75.5954 19.316V15.956H77.3314Z" fill="white"/>
                    </svg>
                  }
                  {matches.mobile && <TrashCan className={"ml-3"}/>}
                </Fragment>
              )}
        </Media> ) : "Delete List" }
    </button>
  )
}
